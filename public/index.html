<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SleepHelper - Your Personal Sleep Comfort Assistant</title>
    <meta name="description" content="Control your sleep environment with ESP8266 - LED strips, fans, and sleep music">
    <meta name="keywords" content="sleep, esp8266, iot, home automation, thai, music, led, fan">
    <meta name="author" content="SleepHelper Team">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#81d4fa">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="SleepHelper">
    
    <!-- Icons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNCIgZmlsbD0iIzgxZDRmYSIvPgo8cGF0aCBkPSJNMTYgOEMxMS41ODE3IDggOCAxMS41ODE3IDggMTZWMTZDOCAyMC40MTgzIDExLjU4MTcgMjQgMTYgMjRDMjAuNDE4MyAyNCAyNCAyMC40MTgzIDI0IDE2VjE2QzI0IDExLjU4MTcgMjAuNDE4MyA4IDE2IDhaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiM4MWQ0ZmEiLz4KPHBhdGggZD0iTTk2IDQ4QzgzLjkwODYgNDggNzQgNTcuOTA4NiA3NCA3MFYxMTRDNzQgMTI2LjA5MSA4My45MDg2IDEzNiA5NiAxMzZDMTA4LjA5MSAxMzYgMTE4IDEyNi4wOTEgMTE4IDExNFY3MEMxMTggNTcuOTA4NiAxMDguMDkxIDQ4IDk2IDQ4WiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+">
    
    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Landing Page -->
    <div class="page landing-page active" id="landingPage">
        <div class="floating-elements">
            <svg class="floating-icon" width="40" height="40" viewBox="0 0 24 24" fill="#ce93d8">
                <path d="M9 21c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1zm3-16C8.48 5 6 7.48 6 10.5c0 .6.1 1.18.29 1.71L5 14h14l-1.29-1.79c.19-.53.29-1.11.29-1.71C18 7.48 15.52 5 12 5z"/>
            </svg>
            <svg class="floating-icon" width="40" height="40" viewBox="0 0 24 24" fill="#81d4fa">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
            <svg class="floating-icon" width="40" height="40" viewBox="0 0 24 24" fill="#ce93d8">
                <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
            </svg>
        </div>

        <div class="container">
            <div class="logo-section">
                <div class="logo">
                    <div class="logo-icon">
                        <svg class="moon-icon" viewBox="0 0 24 24">
                            <path d="M20.742 13.045a8.088 8.088 0 0 1-2.077.271c-2.135 0-4.14-.83-5.646-2.336a8.025 8.025 0 0 1-2.064-7.723A1 1 0 0 0 9.73 2.034a10.014 10.014 0 0 0-4.489 2.582c-3.898 3.898-3.898 10.243 0 14.143a9.937 9.937 0 0 0 7.072 2.93 9.93 9.93 0 0 0 7.07-2.929 10.007 10.007 0 0 0 2.583-4.491 1.001 1.001 0 0 0-1.224-1.224z"/>
                        </svg>
                        <svg class="pillow-icon" viewBox="0 0 24 24">
                            <path d="M7 13c1.66 0 3-1.34 3-3S8.66 7 7 7s-3 1.34-3 3 1.34 3 3 3zm12-6h-8v7H3V9c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v6c0 1.1-.9 2-2 2h-4V7z"/>
                        </svg>
                    </div>
                </div>
                <h1 class="logo-text">SleepHelper</h1>
                <p class="tagline">Your personal sleep comfort assistant</p>
            </div>

            <button class="main-button" onclick="goToControlPage()">
                ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°
            </button>
        </div>
    </div>

    <!-- Control Page -->
    <div class="page control-page" id="controlPage">
        <button class="back-button" onclick="goToLandingPage()">
            ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
        </button>

        <div class="header">
            <h1>üåô Sleep Environment Control</h1>
            <p>‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö</p>
            <div class="connection-status" id="connectionStatus">
                <div class="status-indicator" id="statusIndicator">
                    <div class="status-dot"></div>
                    <span class="status-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</span>
                </div>
                <div class="esp-info" id="espInfo">
                    <span>ESP8266: 172.20.10.7 ‚úÖ</span>
                    <button class="test-connection-btn" onclick="testConnection()" title="‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠">
                        üîÑ
                    </button>
                </div>
            </div>
            
            <!-- Troubleshooting Guide -->
            <div class="troubleshooting-guide" id="troubleshootingGuide" style="display: none;">
                <h3>üîß ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</h3>
                <div class="troubleshooting-steps">
                    <div class="step">
                        <strong>1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö IP Address:</strong>
                        <p>‚Ä¢ ‡πÄ‡∏õ‡∏¥‡∏î Serial Monitor ‡πÉ‡∏ô Arduino IDE</p>
                        <p>‚Ä¢ ‡∏î‡∏π IP Address ‡∏ó‡∏µ‡πà ESP8266 ‡πÅ‡∏™‡∏î‡∏á</p>
                        <p>‚Ä¢ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô IP ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå config.js</p>
                    </div>
                    <div class="step">
                        <strong>2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö WiFi:</strong>
                        <p>‚Ä¢ ESP8266 ‡πÅ‡∏•‡∏∞‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà WiFi ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô</p>
                        <p>‚Ä¢ ‡∏•‡∏≠‡∏á ping IP ‡πÉ‡∏ô Command Prompt</p>
                    </div>
                    <div class="step">
                        <strong>3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ESP8266 Code:</strong>
                        <p>‚Ä¢ ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ Web Server running</p>
                        <p>‚Ä¢ ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ CORS headers</p>
                        <p>‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö endpoints: /status, /play, /pause</p>
                    </div>
                </div>
                <button class="close-guide-btn" onclick="closeTroubleshootingGuide()">‡∏õ‡∏¥‡∏î‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠</button>
            </div>
        </div>

        <div class="controls-container">
            <!-- Light Control Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M9 21c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1zm3-16C8.48 5 6 7.48 6 10.5c0 .6.1 1.18.29 1.71L5 14h14l-1.29-1.79c.19-.53.29-1.11.29-1.71C18 7.48 15.52 5 12 5z"/>
                        </svg>
                    </div>
                    <h2 class="card-title">Light (‡πÅ‡∏™‡∏á)</h2>
                </div>

                <div class="control-group">
                    <label class="control-label">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡πà‡∏≤‡∏á</label>
                    <div class="button-group">
                        <button class="btn active" onclick="setLightLevel(this, 0)">Off</button>
                        <button class="btn" onclick="setLightLevel(this, 1)">1</button>
                        <button class="btn" onclick="setLightLevel(this, 2)">2</button>
                        <button class="btn" onclick="setLightLevel(this, 3)">3</button>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label>
                    <div class="mode-toggle">
                        <span class="mode-label">Fixed</span>
                        <div class="toggle-switch active" onclick="toggleLightMode(this)">
                            <div class="toggle-slider"></div>
                        </div>
                        <span class="mode-label">Timer</span>
                    </div>
                    <div class="timer-select" id="lightTimer" style="display: none;">
                        <button class="btn" onclick="setTimer(this, 'light', 5)">5 ‡∏ô‡∏≤‡∏ó‡∏µ</button>
                        <button class="btn" onclick="setTimer(this, 'light', 10)">10 ‡∏ô‡∏≤‡∏ó‡∏µ</button>
                        <button class="btn" onclick="setTimer(this, 'light', 15)">15 ‡∏ô‡∏≤‡∏ó‡∏µ</button>
                    </div>
                </div>
            </div>

            <!-- Fan Control Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <svg class="fan-icon" viewBox="0 0 24 24">
                            <path d="M12.5 2C13.81 2 15.29 3.42 15.29 5.5C15.29 6.97 14.5 8.27 13.35 9C14.5 9.73 15.29 11.03 15.29 12.5C15.29 14.58 13.81 16 12.5 16C11.03 16 9.73 15.21 9 14.06C8.27 15.21 6.97 16 5.5 16C3.42 16 2 14.58 2 12.5C2 11.03 2.79 9.73 3.94 9C2.79 8.27 2 6.97 2 5.5C2 3.42 3.42 2 5.5 2C6.97 2 8.27 2.79 9 3.94C9.73 2.79 11.03 2 12.5 2M12 10C13.1 10 14 10.9 14 12S13.1 14 12 14 10 13.1 10 12 10.9 10 12 10Z"/>
                        </svg>
                    </div>
                    <h2 class="card-title">Fan (‡∏û‡∏±‡∏î‡∏•‡∏°)</h2>
                </div>

                <div class="control-group">
                    <label class="control-label">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß</label>
                    <div class="button-group">
                        <button class="btn active" onclick="setFanSpeed(this, 0)">Off</button>
                        <button class="btn" onclick="setFanSpeed(this, 1)">1</button>
                        <button class="btn" onclick="setFanSpeed(this, 2)">2</button>
                        <button class="btn" onclick="setFanSpeed(this, 3)">3</button>
                        <button class="btn" onclick="setFanSpeed(this, 4)">4</button>
                        <button class="btn" onclick="setFanSpeed(this, 5)">5</button>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label>
                    <div class="mode-toggle">
                        <span class="mode-label">Fixed speed</span>
                        <div class="toggle-switch active" onclick="toggleFanMode(this)">
                            <div class="toggle-slider"></div>
                        </div>
                        <span class="mode-label">Timer off</span>
                    </div>
                    <div class="timer-select" id="fanTimer" style="display: none;">
                        <button class="btn" onclick="setTimer(this, 'fan', 5)">5 ‡∏ô‡∏≤‡∏ó‡∏µ</button>
                        <button class="btn" onclick="setTimer(this, 'fan', 10)">10 ‡∏ô‡∏≤‡∏ó‡∏µ</button>
                        <button class="btn" onclick="setTimer(this, 'fan', 15)">15 ‡∏ô‡∏≤‡∏ó‡∏µ</button>
                    </div>
                </div>
            </div>

            <!-- Sound Control Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
                        </svg>
                    </div>
                    <h2 class="card-title">Music Player (‡πÄ‡∏û‡∏•‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏°)</h2>
                </div>

                <div class="control-group">
                    <label class="control-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏•‡∏á</label>
                    <select class="dropdown" id="soundSelect" onchange="selectSound(this.value)">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏•‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏°</option>
                        <option value="rain">üåßÔ∏è ‡∏ù‡∏ô‡∏ï‡∏Å</option>
                        <option value="ocean">üåä ‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡∏ó‡∏∞‡πÄ‡∏•</option>
                        <option value="lullaby">üéµ ‡πÄ‡∏û‡∏•‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏°</option>
                        <option value="therapy">üé∂ ‡πÄ‡∏û‡∏•‡∏á‡∏ö‡∏≥‡∏ö‡∏±‡∏î</option>
                        <option value="dhamma">üôè ‡∏ö‡∏ó‡∏ò‡∏±‡∏°‡∏à‡∏±‡∏Å‡∏£‡∏Å‡∏±‡∏õ‡∏õ‡∏ß‡∏±‡∏ï‡∏ô‡∏™‡∏π‡∏ï‡∏£</option>
                        <option value="mongkol">üìø ‡∏£‡∏ß‡∏°‡∏ö‡∏ó‡∏°‡∏á‡∏Ñ‡∏•</option>
                        <option value="tibet">üîî ‡∏Ç‡∏±‡∏ô‡∏ó‡∏¥‡πÄ‡∏ö‡∏ï</option>
                        <option value="frequency">üéØ 432Hz+528Hz</option>
                        <option value="piano">üéπ ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏õ‡∏µ‡∏¢‡πÇ‡∏ô</option>
                        <option value="mozart">üéº ‡πÇ‡∏°‡∏™‡∏≤‡∏£‡πå‡∏ó‡∏Å‡∏•‡πà‡∏≠‡∏°‡∏ô‡∏≤‡∏ô</option>
                    </select>
                </div>

                <div class="control-group">
                    <label class="control-label">‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÄ‡∏û‡∏•‡∏á</label>
                    <div class="music-controls">
                        <button class="music-btn" onclick="previousTrack()" title="‡πÄ‡∏û‡∏•‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤">
                            <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                                <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/>
                            </svg>
                        </button>
                        <button class="music-btn play-pause-btn" onclick="togglePlayPause()" title="‡πÄ‡∏•‡πà‡∏ô/‡∏´‡∏¢‡∏∏‡∏î" id="playPauseBtn">
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor" id="playIcon">
                                <path d="M8 5v14l11-7z"/>
                            </svg>
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor" id="pauseIcon" style="display: none;">
                                <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                            </svg>
                        </button>
                        <button class="music-btn" onclick="nextTrack()" title="‡πÄ‡∏û‡∏•‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ">
                            <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                                <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
                            </svg>
                        </button>
                    </div>
                    <div class="now-playing" id="nowPlaying">
                        <span class="track-name">‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏•‡∏á</span>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á (0-100%)</label>
                    <div class="slider-container">
                        <input type="range" min="0" max="100" value="50" class="slider" id="soundVolume" oninput="updateVolume(this.value)">
                        <div class="slider-value" id="volumeValue">50%</div>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label>
                    <div class="mode-toggle">
                        <span class="mode-label">Loop</span>
                        <div class="toggle-switch active" onclick="toggleSoundMode(this)">
                            <div class="toggle-slider"></div>
                        </div>
                        <span class="mode-label">Timer</span>
                    </div>
                    <div class="timer-select" id="soundTimer" style="display: none;">
                        <button class="btn" onclick="setTimer(this, 'sound', 5)">5 ‡∏ô‡∏≤‡∏ó‡∏µ</button>
                        <button class="btn" onclick="setTimer(this, 'sound', 10)">10 ‡∏ô‡∏≤‡∏ó‡∏µ</button>
                        <button class="btn" onclick="setTimer(this, 'sound', 15)">15 ‡∏ô‡∏≤‡∏ó‡∏µ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Bar -->
    <div class="status-bar" id="statusBar">
        <div id="statusText">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
    </div>

    <script src="config.js"></script>
    <script src="app.js"></script>
</body>
</html>
